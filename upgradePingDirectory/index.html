
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://devops.pingidentity.com/upgradePingDirectory/">
      
      
      <link rel="shortcut icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.6">
    
    
      
        <title>Upgrading PingDirectory - Ping Identity DevOps</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6910b76c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.196e0c26.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../mkdocs/overrides/stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="blue">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#upgrading-pingdirectory-in-a-devops-environment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://devops.pingidentity.com/" title="Ping Identity DevOps" class="md-header-nav__button md-logo" aria-label="Ping Identity DevOps">
      <!-- Logo -->

  


    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Ping Identity DevOps
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Upgrading PingDirectory
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/pingidentity/pingidentity-devops-getting-started" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pingidentity/pingidentity-devops-getting-started
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
    
    <a href=".." class="md-tabs__link">
      DevOps @ Ping
    </a>
  </li>

      
        
      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../getStarted/" class="md-tabs__link">
        Get Started
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../deploy/" class="md-tabs__link">
        Working With Images
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
        
      
      <a href="../config/" class="md-tabs__link md-tabs__link--active">
        Customizing
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../relnotes-2010/" class="md-tabs__link">
        Release Notes
      </a>
    </li>
  

      
        
      
        
      
        
      
        
      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://devops.pingidentity.com/" title="Ping Identity DevOps" class="md-nav__button md-logo" aria-label="Ping Identity DevOps">
      <!-- Logo -->

  


    </a>
    Ping Identity DevOps
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pingidentity/pingidentity-devops-getting-started" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pingidentity/pingidentity-devops-getting-started
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      DevOps @ Ping
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../overview/" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    <label class="md-nav__link" for="nav-3">
      Get Started
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Get Started" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Get Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../getStarted/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../devopsRegistration/" class="md-nav__link">
      DevOps Registration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../getStartedWithGitRepo/" class="md-nav__link">
      Deploy Example Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../prodLicense/" class="md-nav__link">
      DevOps Product Licenses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../devopsUserKey/" class="md-nav__link">
      Using Your DevOps User and Key
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../existingLicense/" class="md-nav__link">
      Using Existing Product License
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../saveConfigs/" class="md-nav__link">
      Saving Your Configuration Changes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    <label class="md-nav__link" for="nav-4">
      Working With Images
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Working With Images" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Working With Images
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../deploy/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../buildLocal/" class="md-nav__link">
      Build Image Locally
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3" >
    <label class="md-nav__link" for="nav-4-3">
      Deploy with Docker-Compose
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Deploy with Docker-Compose" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        <span class="md-nav__icon md-icon"></span>
        Deploy with Docker-Compose
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../deployCompose/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deploySimpleStack/" class="md-nav__link">
      Deploy PingFederate and PingDirectory Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployReplication/" class="md-nav__link">
      Deploy Replicated PingDirectory Pair
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deploySync/" class="md-nav__link">
      Deploy PingDirectory and PingDataSync
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployPingCentral/" class="md-nav__link">
      Deploy PingCentral
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployPfCluster/" class="md-nav__link">
      Deploy PingFederate Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployPaCluster/" class="md-nav__link">
      Deploy PingAccess Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployPdgPap/" class="md-nav__link">
      Deploy PingDataGovernance with PAP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployMonitoringStack/" class="md-nav__link">
      Deploy Monitoring Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deploySiemStack/" class="md-nav__link">
      Deploy an Elasticsearch SIEM Stack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4" >
    <label class="md-nav__link" for="nav-4-4">
      Deploy with Kubernetes
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Deploy with Kubernetes" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        <span class="md-nav__icon md-icon"></span>
        Deploy with Kubernetes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8s/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployHelm/" class="md-nav__link">
      Deploy with PingIdentiy Helm Charts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8sPD-clusters/" class="md-nav__link">
      PingDirectory Deployments Across Kubernetes Clusters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4-4" type="checkbox" id="nav-4-4-4" >
    <label class="md-nav__link" for="nav-4-4-4">
      Kubernetes Deployments For General Use
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Kubernetes Deployments For General Use" data-md-level="3">
      <label class="md-nav__title" for="nav-4-4-4">
        <span class="md-nav__icon md-icon"></span>
        Kubernetes Deployments For General Use
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8sGeneral/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8sStandalone/" class="md-nav__link">
      Orchestrate Standalone Deployments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8sFullstack/" class="md-nav__link">
      Orchestrate a Full Stack Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8sReplicated/" class="md-nav__link">
      Orchestrate a Replicated PingDirectory Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8sPA-cluster/" class="md-nav__link">
      Orchestrate a PingAccess Cluster Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8sPF-cluster/" class="md-nav__link">
      Orchestrate a PingFederate Cluster Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4-4-7" type="checkbox" id="nav-4-4-4-7" >
    <label class="md-nav__link" for="nav-4-4-4-7">
      Deploy PingFederate Across Multiple Kubernetes Clusters
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Deploy PingFederate Across Multiple Kubernetes Clusters" data-md-level="4">
      <label class="md-nav__title" for="nav-4-4-4-7">
        <span class="md-nav__icon md-icon"></span>
        Deploy PingFederate Across Multiple Kubernetes Clusters
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8sPFclusters/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployPFMultiRegionDNS/" class="md-nav__link">
      PingFederate Across Kubernetes with DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployPFMultiRegionAWS/" class="md-nav__link">
      PingFederate Across Kubernetes with S3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4-4-5" type="checkbox" id="nav-4-4-5" >
    <label class="md-nav__link" for="nav-4-4-5">
      Kubernetes Deployments For Cloud Platforms
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Kubernetes Deployments For Cloud Platforms" data-md-level="3">
      <label class="md-nav__title" for="nav-4-4-5">
        <span class="md-nav__icon md-icon"></span>
        Kubernetes Deployments For Cloud Platforms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8sCloud/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8s-AWS/" class="md-nav__link">
      Deploy Peered EKS Clusters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployK8s-AKS/" class="md-nav__link">
      Deploy to Azure Kubernetes Service
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../k8sClusterSizing/" class="md-nav__link">
      Sizing Kubernetes Clusters
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployVault/" class="md-nav__link">
      Deploy Hashicorp Vault
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    <label class="md-nav__link" for="nav-5">
      Customizing
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Customizing" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Customizing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../config/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2" >
    <label class="md-nav__link" for="nav-5-2">
      Server Profiles
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Server Profiles" data-md-level="2">
      <label class="md-nav__title" for="nav-5-2">
        <span class="md-nav__icon md-icon"></span>
        Server Profiles
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../containerAnatomy/" class="md-nav__link">
      Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../profileStructures/" class="md-nav__link">
      Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../profiles/" class="md-nav__link">
      Customization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../buildPingFederateProfile/" class="md-nav__link">
      Build Your Own ...
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../profilesLayered/" class="md-nav__link">
      Layering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../profilesSubstitution/" class="md-nav__link">
      Env Substitution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../privateRepos/" class="md-nav__link">
      Private Github Repos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../yamlFiles/" class="md-nav__link">
      Customizing YAML files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../variableScoping/" class="md-nav__link">
      Variables and Scope
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../usingCertificates/" class="md-nav__link">
      Using Certificates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hooks/" class="md-nav__link">
      Using DevOps Hooks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../releaseTags/" class="md-nav__link">
      Using Release Tags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../imageSupport/" class="md-nav__link">
      Using Supported Images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../usingVault/" class="md-nav__link">
      Using Hashicorp Vault
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../secureContainers/" class="md-nav__link">
      Securing the Containers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dockerImageSecurity/" class="md-nav__link">
      Eval of DevOps Image Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../addMOTD/" class="md-nav__link">
      Adding a MOTD
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-13" type="checkbox" id="nav-5-13" checked>
    <label class="md-nav__link" for="nav-5-13">
      Managing Deployments
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Managing Deployments" data-md-level="2">
      <label class="md-nav__title" for="nav-5-13">
        <span class="md-nav__icon md-icon"></span>
        Managing Deployments
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../manage/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upgradePingfederate/" class="md-nav__link">
      Upgrading PingFederate
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Upgrading PingDirectory
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Upgrading PingDirectory
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tips" class="md-nav__link">
    Tips
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-youll-do" class="md-nav__link">
    What you'll do
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#partition" class="md-nav__link">
    Partition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage" class="md-nav__link">
    Stage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rollout" class="md-nav__link">
    Rollout
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-14" type="checkbox" id="nav-5-14" >
    <label class="md-nav__link" for="nav-5-14">
      Utilities
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Utilities" data-md-level="2">
      <label class="md-nav__title" for="nav-5-14">
        <span class="md-nav__icon md-icon"></span>
        Utilities
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../pingDevopsUtil/" class="md-nav__link">
      ping-devops
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ldapsdkUtil/" class="md-nav__link">
      ldap-sdk-tools
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../troubleshooting/" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5-16" type="checkbox" id="nav-5-16" >
    <label class="md-nav__link" for="nav-5-16">
      DevOps Images Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="DevOps Images Reference" data-md-level="2">
      <label class="md-nav__title" for="nav-5-16">
        <span class="md-nav__icon md-icon"></span>
        DevOps Images Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dockerImagesRef/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingfederate/" class="md-nav__link">
      PingFederate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingaccess/" class="md-nav__link">
      PingAccess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingdirectory/" class="md-nav__link">
      PingDirectory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingdirectoryproxy/" class="md-nav__link">
      PingDirectoryProxy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingdatagovernance/" class="md-nav__link">
      PingDataGovernance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingdatagovernancepap/" class="md-nav__link">
      PingDataGovernance PAP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingdatasync/" class="md-nav__link">
      PingDataSync
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingdelegator/" class="md-nav__link">
      PingDelegator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingcentral/" class="md-nav__link">
      PingCentral
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingintelligence/" class="md-nav__link">
      PingIntelligence
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/ldap-sdk-tools/" class="md-nav__link">
      ldap-sdk-tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingdataconsole/" class="md-nav__link">
      Ping Data Console
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingdownloader/" class="md-nav__link">
      PingDownloader
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingbase/" class="md-nav__link">
      PingBase
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingcommon/" class="md-nav__link">
      PingCommon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/pingdatacommon/" class="md-nav__link">
      PingDataCommon
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker-images/apache-jmeter/" class="md-nav__link">
      Apache JMeter
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
    <label class="md-nav__link" for="nav-6">
      Release Notes
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Release Notes" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Release Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../relnotes-2010/" class="md-nav__link">
      Current
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../relnotes-2009/" class="md-nav__link">
      Version 2009
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../relnotes-2008/" class="md-nav__link">
      Version 2008
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../relnotes-2007/" class="md-nav__link">
      Version 2007
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../relnotes-2006/" class="md-nav__link">
      Version 2006
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../relnotes-2005/" class="md-nav__link">
      Version 2005
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../relnotes-2004/" class="md-nav__link">
      Version 2004
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../relnotes-2003/" class="md-nav__link">
      Version 2003
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../license/" class="md-nav__link">
      License
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../disclaimer/" class="md-nav__link">
      Disclaimer
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../3rd_party_software/" class="md-nav__link">
      Third-Party Software
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contributing/" class="md-nav__link">
      Contributing
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tips" class="md-nav__link">
    Tips
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-youll-do" class="md-nav__link">
    What you'll do
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#partition" class="md-nav__link">
    Partition
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stage" class="md-nav__link">
    Stage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rollout" class="md-nav__link">
    Rollout
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="upgrading-pingdirectory-in-a-devops-environment">Upgrading PingDirectory in a DevOps environment<a class="headerlink" href="#upgrading-pingdirectory-in-a-devops-environment" title="Permanent link"> ¶</a></h1>
<p>Because PingDirectory is essentially a database, in it's container form each node in a cluster has its own persisted volume. Additionally, because PingDirectory is an application that <em>focuses</em> on state, rolling out an upgrade isn't really the same as any other configuration update. However, the product software, and scripts in the image provide a process through which upgrades are drastically simplified. </p>
<p>This use case focuses on a PingDirectory upgrade in a default Kubernetes environment. You'll upgrade a PingDirectory StatefulSet 8.0.0.1 to 8.1.0.0 using an incremental canary roll-out. </p>
<h2 id="tips">Tips<a class="headerlink" href="#tips" title="Permanent link"> ¶</a></h2>
<p>To ensure a successful upgrade process:</p>
<ul>
<li>
<p>Avoid combining configuration changes and version upgrades in the same rollout. This adds unnecessary complexity to debugging errors during an upgrade.</p>
</li>
<li>
<p>Successfully complete an upgrade in a proper Dev/QA environment before trying anything in production. </p>
</li>
<li>
<p>Upgrades will happen on one server at a time. Ensure you have enough resources on the remaining machines to prevent client impact.</p>
</li>
<li>
<p>Follow a canary deployment pattern to ensure the changes will be successful before doing a full rollout. There is no <em>good</em> way to roll back a completed upgrade, so take any necessary steps to avoid this.</p>
</li>
</ul>
<h2 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link"> ¶</a></h2>
<ul>
<li>
<p>You've already been through <a href="../getStarted/">Get started</a> to set up your DevOps environment and run a test deployment of the products.</p>
</li>
<li>
<p>You've cloned or downloaded the <code>pingidentity-devops-getting-started/20-kubernetes/12-pingdirectory-upgrade</code> repository to your local <code>${HOME}/projects/devops</code> directory.</p>
</li>
<li>
<p>A good understanding of how to use our DevOps server profiles.</p>
</li>
<li>
<p>Access to a Kubernetes cluster and a default StorageClass.</p>
</li>
<li>
<p>An understanding of StatefulSets in Kubernetes is helpful.</p>
</li>
<li>
<p>If you're upgrading in your own environment and using mounted licenses, the license for the existing version needs to be in the <code>/opt/out</code> persisted volume, and a license for the new version needs to be in <code>/opt/in</code>. The license locations are not an needed if you're using our DevOps credentials in an evaluation context.</p>
</li>
</ul>
<h2 id="what-youll-do">What you'll do<a class="headerlink" href="#what-youll-do" title="Permanent link"> ¶</a></h2>
<ul>
<li>
<p><a href="#setup">Setup</a>. Start with a base stack.</p>
</li>
<li>
<p><a href="#partition">Partition</a>. Set up a partition to make changes on just one node.</p>
</li>
<li>
<p><a href="#stage">Stage</a>. Deploy changes to one node and fix any errors.</p>
</li>
<li>
<p><a href="#rollout">Rollout</a>. Rollout changes to other nodes.</p>
</li>
</ul>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link"> ¶</a></h2>
<p>The key functionality for PingDirectory upgrades is the relationship between the image hooks and the <code>manage-profile</code> command in the product. </p>
<p>The upgrade is processed in this way:</p>
<ol>
<li>
<p>When a node starts for the first time it is in <code>SETUP</code> mode and runs <code>manage-profile setup</code>. </p>
</li>
<li>
<p>When a node restarts (for whatever reason), it runs <code>manage-profile replace-profile</code>. </p>
</li>
<li>
<p>This command compares the new profile to the old profile, and if there is a change, it tries standing up the server with the new profile. </p>
</li>
<li>
<p>Errors will be thrown if there is a configuration in the new profile that prevents it from being applied. </p>
</li>
<li>
<p>If <code>manage-profile replace-profile</code> detects a product version difference, it takes the same approach as any other restart. It will attempt to migrate PingDirectory to the new version, and the command will fail if it cannot. </p>
</li>
</ol>
<p>Because there is processing that happens automatically in the container during the upgrade, you want to roll the change out to a small partition first and test it thoroughly before rolling it out to all. This partition also gives us room to revert back without impacting traffic in case something is not as expected. </p>
<p>This process in standard Kubernetes is called a Canary Rollout and is derived from <a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#update-strategies">Kubernetes documentation on StatefulSet update strategies</a>.</p>
<blockquote>
<p>"Canary Rollout" in this scenario focuses only on an incremental rollout of containers, not actually separating traffic. That could be done with additional tools like Istio, or standing up another service and pairing separate labels and selectors. </p>
</blockquote>
<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link"> ¶</a></h2>
<p>The YAML configuration files for this use case are in your local </p>
<ol>
<li>
<p>Use the <code>1-initial.yaml</code> file in your local <code>pingidentity-devops-getting-started/20-kubernetes/12-pingdirectory-upgrade</code> directory to start with a PingDirectory StatefulSet using persistent volumes. Enter:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f <span class="m">1</span>-initial.yaml
</code></pre></div>
</li>
</ol>
<blockquote>
<p>All kubectl commands for this use case need to be run from the <code>pingidentity-devops-getting-started/20-kubernetes/12-pingdirectory-upgrade</code> directory. </p>
</blockquote>
<p>This will stand up a two directory topology, each with its own Persistent Volume Claim using the default storage class. </p>
<ol>
<li>Wait for both nodes to be healthy before continuing. Enter:</li>
</ol>
<div class="highlight"><pre><span></span><code>kubectl get pods
</code></pre></div>
<p><code>pingdirectory-0</code> and <code>pingdirectory-1</code> should show <code>1/1</code> in the <code>READY</code> column.</p>
<h2 id="partition">Partition<a class="headerlink" href="#partition" title="Permanent link"> ¶</a></h2>
<p>Use the <code>2-partition.yaml</code> file in your local <code>pingidentity-devops-getting-started/20-kubernetes/12-pingdirectory-upgrade</code> directory to add a partition to <code>StatefulSet</code> for <code>updateStrategy</code>. Enter: </p>
<div class="highlight"><pre><span></span><code>kubectl apply -f 2-partition.yaml
</code></pre></div>
<p>This partition configuration signifies that any changes to <code>spec.template</code> will only be applied to nodes with a cardinal value higher than the partition definition.</p>
<h2 id="stage">Stage<a class="headerlink" href="#stage" title="Permanent link"> ¶</a></h2>
<p>Use the <code>3-staging.yaml</code> file in your local <code>pingidentity-devops-getting-started/20-kubernetes/12-pingdirectory-upgrade</code> directory to stage the change. Enter:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f <span class="m">3</span>-staging.yaml
</code></pre></div>
<p>The only <em>actual</em> change is to the image tag. When this change is applied:</p>
<ol>
<li>
<p>The <code>pingdirectory-1</code> pod will be terminated and a new one with the new image will started.</p>
</li>
<li>
<p>The new PingDirectory container is based on a specific version of PingDirectory, found in the <code>/opt/server</code> volume. </p>
</li>
<li>
<p>The <code>manage-profile replace-profile</code> command will eventually be triggered when the container detects PingDirectory is in a <code>RESTART</code> state. This command identifies the difference in the database version running, based on the persisted volume attached to <code>/opt/out</code>, and then attempts to upgrade. Information similar to the following will be displayed:</p>
<div class="highlight"><pre><span></span><code>...
pingdirectory-1 Validating source and existing servers ..... Done
pingdirectory-1 Updating the server version from 8.0.0.1 to 8.1.0.0. Local database backends
pingdirectory-1 will be exported before the update in case a revert is necessary
pingdirectory-1 Exporting backend with backendID userRoot. This may take a while ..... Done
pingdirectory-1 Running the update tool ..... Done
...
pingdirectory-1 Cleaning up after replace ..... Done
pingdirectory-1   manage-profile replace-profile returned 0
</code></pre></div>
</li>
</ol>
<blockquote>
<p>This process requires having licenses for both server versions available and in the right location.</p>
</blockquote>
<p>If <code>manage-profile replace-profile</code> completes without error, you'll see the container continue the migration and eventually start up PingDirectory. </p>
<p>If <code>manage-profile replace-profile</code> fails, an error is displayed and the container will exit. The errors will be due to some conflict in the server profile. The partition you set up previously provides an isolated environment for working out errors. Work through any errors until you can get <code>manage-profile replace-profile</code> to complete successfully before continuing.</p>
<h2 id="rollout">Rollout<a class="headerlink" href="#rollout" title="Permanent link"> ¶</a></h2>
<p>When you're confident your upgrade will occur smoothly, use the <code>4-rollout.yaml</code> file in your local <code>pingidentity-devops-getting-started/20-kubernetes/12-pingdirectory-upgrade</code> directory to deploy the rollout to the remaining nodes. This will remove the partition. Enter:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f <span class="m">4</span>-rollout.yaml
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../upgradePingfederate/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Upgrading PingFederate
              </div>
            </div>
          </a>
        
        
          <a href="../pingDevopsUtil/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                ping-devops
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.fd16492e.min.js"></script>
      <script src="../assets/javascripts/bundle.7836ba4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: ['navigation.tabs', 'instant'],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>